{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://socialflow.com/schemas/user/preferences_schema.json",
  "title": "UserPreferences",
  "description": "User preferences and feature toggles. Non-sensitive preferences that can be surfaced in UI or used by personalization services.",
  "type": "object",
  "required": ["user_id"],
  "additionalProperties": false,
  "properties": {
    "user_id": { "type": "string", "format": "uuid" },
    "locale": { "type": "string", "description": "BCP-47 locale code" },
    "timezone": { "type": "string", "description": "IANA timezone (e.g., Asia/Kolkata)" },
    "email_notifications": {
      "type": "object",
      "properties": {
        "marketing": { "type": "boolean", "default": false },
        "product_updates": { "type": "boolean", "default": true },
        "digest_frequency": { "type": "string", "enum": ["none", "daily", "weekly", "monthly"], "default": "weekly" }
      }
    },
    "push_notifications": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "sound": { "type": "boolean", "default": true },
        "do_not_disturb": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "start": { "type": "string", "pattern": "^([01]\\d|2[0-3]):([0-5]\\d)$" },
            "end": { "type": "string", "pattern": "^([01]\\d|2[0-3]):([0-5]\\d)$" }
          }
        }
      }
    },
    "content_preferences": {
      "type": "object",
      "properties": {
        "language_filters": {
          "type": "array",
          "items": { "type": "string" }
        },
        "mature_content": { "type": "string", "enum": ["allow", "warn", "block"], "default": "warn" }
      }
    },
    "feature_flags": {
      "type": "object",
      "description": "Map of flag->variant (useful for experiments).",
      "additionalProperties": {
        "type": ["string", "boolean", "number", "null"]
      },
      "default": {}
    },
    "ui_settings": {
      "type": "object",
      "properties": {
        "theme": { "type": "string", "enum": ["light", "dark", "system"], "default": "system" },
        "compact_view": { "type": "boolean", "default": false },
        "items_per_page": { "type": "integer", "minimum": 5, "maximum": 200, "default": 20 }
      }
    }
  }
}
