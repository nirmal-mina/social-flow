{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://socialflow.com/schemas/validation/regex_patterns_schema.json",
  "title": "RegexPatternsRegistry",
  "description": "Registry of vetted regex patterns used across the system. Patterns must be tested for ReDoS safety and have owner/notes.",
  "type": "object",
  "additionalProperties": {
    "type": "object",
    "required": ["pattern", "flags", "description", "safe"],
    "properties": {
      "pattern": { "type": "string", "description": "The regex pattern string (use double escaping when embedding in JSON)." },
      "flags": { "type": "string", "description": "Regex flags (i, m, u, etc.)", "default": "" },
      "description": { "type": "string" },
      "examples": { "type": "array", "items": { "type": "string" } },
      "safe": { "type": "boolean", "description": "Whether the pattern has been checked for ReDoS and accepted." },
      "owner": { "type": "string", "description": "Person or team owning this pattern." },
      "last_reviewed": { "type": ["string", "null"], "format": "date" }
    },
    "additionalProperties": false
  }
}
