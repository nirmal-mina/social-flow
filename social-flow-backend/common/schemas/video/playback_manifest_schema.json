{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://socialflow.com/schemas/video/playback_manifest_schema.json",
  "title": "PlaybackManifest",
  "description": "Manifest describing how the playback client should fetch media (HLS/DASH endpoints, renditions, DRM hints).",
  "type": "object",
  "required": ["video_id", "manifest_id", "created_at", "protocol", "renditions"],
  "additionalProperties": false,
  "properties": {
    "manifest_id": { "type": "string", "format": "uuid" },
    "video_id": { "type": "string", "format": "uuid" },
    "protocol": { "type": "string", "enum": ["hls", "dash"], "description": "Playback streaming protocol." },
    "primary_url": { "type": "string", "format": "uri", "description": "Primary URL to manifest file (HLS .m3u8 or DASH .mpd)." },
    "cdn_hints": { "type": "array", "items": { "type": "string" }, "description": "Preferred CDN endpoints or regions." },
    "renditions": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["asset_id", "bandwidth", "width", "height", "url"],
        "properties": {
          "asset_id": { "type": "string" },
          "bandwidth": { "type": "integer", "minimum": 0, "description": "Bits per second recommended for this rendition." },
          "width": { "type": "integer", "minimum": 0 },
          "height": { "type": "integer", "minimum": 0 },
          "mime_type": { "type": "string" },
          "url": { "type": "string", "format": "uri" },
          "drm": {
            "type": "object",
            "properties": {
              "scheme": { "type": "string" },
              "license_url": { "type": "string", "format": "uri" }
            }
          }
        },
        "additionalProperties": false
      }
    },
    "subtitle_tracks": {
      "type": "array",
      "items": { "$ref": "https://socialflow.com/schemas/video/caption_schema.json" }
    },
    "created_at": { "type": "string", "format": "date-time" },
    "etag": { "type": ["string", "null"], "description": "ETag for manifest caching/validation." }
  }
}
