# =========================
# File: testing/security/vulnerability/parsers/packagejson_parser.py
"""
Parses package.json to extract dependencies and devDependencies.
"""
import json
from pathlib import Path

def parse_packagejson(path: Path):
    with open(path, "r", encoding="utf-8", errors="ignore") as f:
        data = json.load(f)
    deps = []
    for section in ("dependencies", "devDependencies", "peerDependencies"):
        for name, ver in data.get(section, {}).items():
            deps.append({"name": name, "version": ver, "section": section})
    return deps
