# =========================
# File: testing/security/vulnerability/utils/fileutils.py
"""
Small helpers for reading files robustly and safely.
"""
from pathlib import Path

def read_text_safe(path: Path, max_size=2_000_000):
    try:
        sz = path.stat().st_size
        if sz > max_size:
            # avoid reading huge binaries
            return None
        with open(path, "r", encoding="utf-8", errors="ignore") as f:
            return f.read()
    except Exception:
        return None
