# =========================
# File: testing/security/vulnerability/utils/vulnerability_db.py
"""
Local vulnerability DB stub.
This provides a simple, offline way to match package names/versions to known CVEs.
In production, replace or extend with integration to:
 - OSV.dev API
 - NVD feeds
 - vendor advisory feeds
The interface here is intentionally tiny so it can be swapped.
"""
from typing import List, Dict

# Example in-memory DB
SAMPLE_DB = {
    # name -> list of vulnerability dicts
    "insecure-lib": [{"cve": "CVE-2020-XXXX", "severity": "HIGH", "fixed_in": "1.2.3", "description": "example vuln"}]
}

class VulnerabilityDB:
    def __init__(self, offline=True):
        self.offline = offline
        # in production load a local index or cache
        self.db = SAMPLE_DB

    def lookup(self, name: str, version: str = None) -> List[Dict]:
        # very simple matching; real use should use normalized names and semver checks
        if name in self.db:
            return self.db[name]
        return []
