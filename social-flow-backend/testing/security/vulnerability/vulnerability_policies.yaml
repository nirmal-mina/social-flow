# =========================
# File: testing/security/vulnerability/vulnerability_policies.yaml
# =========================
# Policy-driven configuration for vulnerability tests.
policies:
  - id: VULN-DEP-001
    description: "Scan dependency manifests for known CVEs and outdated packages"
    enabled: true
    targets: ["repo"]
    severity: high
    settings:
      package_manifests: ["requirements.txt", "package.json"]
      allow_offline_lookup: true   # if true, use local db; else require online CVE provider

  - id: VULN-SSA-001
    description: "Static source analysis for common insecure patterns (SQL concat, insecure deserialization)"
    enabled: true
    targets: ["repo","source"]
    severity: high
    settings:
      file_types: [".py", ".js", ".java"]
      max_issues_per_file: 25

  - id: VULN-SECRET-001
    description: "Heuristic scanning for probable secrets in repo (API keys, tokens)"
    enabled: true
    targets: ["repo"]
    severity: critical
    settings:
      entropy_threshold: 4.5
      exclude_paths: [".git/", "node_modules/"]

  - id: VULN-CONFIG-001
    description: "Check configuration files for insecure values (debug=true, weak TLS settings)"
    enabled: true
    targets: ["repo", "config"]
    severity: medium
    settings:
      config_files: ["*.yml", "*.yaml", "*.json", "Dockerfile"]
