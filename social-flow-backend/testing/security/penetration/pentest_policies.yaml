# =========================
# File: testing/security/penetration/pentest_policies.yaml
# =========================
# Policy-driven configuration for penetration tests.
# Fields:
#  - id: unique policy id
#  - description: human readable
#  - enabled: whether the test runs
#  - safe_mode: if true, use non-destructive check variants
#  - targets: list of targets or target groups this policy applies to
policies:
  - id: PENTEST-PORTS-001
    description: "TCP port discovery (connect scan). Respect rate limits."
    enabled: true
    safe_mode: true
    targets: ["infrastructure"]
    settings:
      ports: [22, 80, 443, 8080, 3306, 5432]
      timeout_seconds: 1
      concurrency: 40

  - id: PENTEST-WEB-001
    description: "Web application reconnaissance: headers, TLS, robots, basic directory enumeration (safe)."
    enabled: true
    safe_mode: true
    targets: ["web"]

  - id: PENTEST-AUTH-001
    description: "Auth brute-force simulator (dry-run) with throttling. Will NOT submit credentials unless explicit override."
    enabled: true
    safe_mode: true
    targets: ["auth-service"]
    settings:
      max_attempts_per_minute: 10
      wordlist: "wordlists/common-passwords.txt"
