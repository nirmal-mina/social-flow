{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://socialflow.com/schemas/validation/password_policy_schema.json",
  "title": "PasswordPolicy",
  "description": "Defines password complexity, reuse, blacklist and lifecycle policies. This is used by auth service and password validators.",
  "type": "object",
  "required": ["min_length", "max_length", "disallow_common_passwords", "history_count", "expiry_days"],
  "properties": {
    "policy_id": { "type": "string" },
    "min_length": { "type": "integer", "minimum": 6, "description": "Minimum allowed length." },
    "max_length": { "type": "integer", "minimum": 8, "description": "Maximum allowed length." },
    "require_uppercase": { "type": "boolean", "default": true },
    "require_lowercase": { "type": "boolean", "default": true },
    "require_digits": { "type": "boolean", "default": true },
    "require_symbols": { "type": "boolean", "default": false },
    "min_entropy_bits": { "type": ["number", "null"], "description": "Optional entropy threshold (zxcvbn style)." },
    "disallow_common_passwords": { "type": "boolean", "description": "If true, check against common-password list." },
    "common_password_list_version": { "type": ["string", "null"] },
    "history_count": { "type": "integer", "minimum": 0, "description": "Number of previous hashes to prevent reuse." },
    "expiry_days": { "type": ["integer", "null"], "description": "If null, passwords do not expire." },
    "blacklist": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of disallowed substrings (e.g., company name, username)."
    },
    "rate_limit_per_minute": { "type": "integer", "minimum": 0, "description": "Attempt throttle for password change endpoints." },
    "notes": { "type": "string" }
  }
}
