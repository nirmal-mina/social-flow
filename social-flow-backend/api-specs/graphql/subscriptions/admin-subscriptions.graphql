"""
Admin & moderation real-time streams. Only admin/moderator roles may open these.
Includes moderation queue updates, live audit events, and report escalations.
"""

scalar DateTime
scalar JSON

type Subscription {
  """
  Stream of new reports entering moderation queue (filtered by severity & type).
  """
  newReport(input: AdminNewReportInput!): Report!

  """
  Updates to reports (assignment, resolution).
  """
  reportUpdated(input: ReportUpdatedSubscriptionInput!): Report!

  """
  Audit log streaming for realtime auditing; restrict to high-trust transport.
  """
  auditLogStream(input: AuditLogStreamInput!): AuditLog!
}

input AdminNewReportInput {
  severity: [ReportSeverity!] = [LOW, MEDIUM, HIGH, CRITICAL]
  contentTypes: [ContentType!]
  assignedTo: ID                 # subscribe only to reports assigned to this admin
  subscriptionToken: String
}

input ReportUpdatedSubscriptionInput {
  reportIds: [ID!]
  statuses: [ReportStatus!]
  subscriptionToken: String
}

input AuditLogStreamInput {
  actorIds: [ID!]
  actionTypes: [String!]
  minTimestamp: DateTime
  subscriptionToken: String
}

# Reuse Report, AuditLog, ReportSeverity, ReportStatus, and ContentType from shared schemas.

# Security & scaling notes:
#
# - Admin subscriptions must require elevated auth and MFA for critical streams.
# - Consider signing events, using ephemeral tokens, and routing through a private broker.
# - Rate-limit and sample audit streams to avoid information overload; provide historical
#   query APIs for full audit retrieval rather than streaming everything.
